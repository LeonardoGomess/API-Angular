<div class="funcionario-wrapper">
  <h2>Funcionários</h2>

  <div *ngIf="mensagem" class="mensagem-sucesso">{{ mensagem }}</div>
  <div *ngIf="erro" class="mensagem-erro">{{ erro }}</div>

  <!-- Filtro / listagem de departamentos (primeiro campo) -->
  <div class="form-row filter-row">
    <label class="stack" style="align-items:center;">
      <span class="muted">Listar Funcionários:</span>
      <select class="compact" [(ngModel)]="departamentoSelecionado" (change)="selecionarDepartamento(departamentoSelecionado)">
        <option [ngValue]="null">Selecione o Departamento</option>
        <option *ngFor="let dep of departamentos" [ngValue]="dep.id">{{ dep.nome }}</option>
      </select>
    </label>
  </div>

  <!-- Form principal: Nome do funcionário (segundo) e selecionar departamento (terceiro) -->
  <form (ngSubmit)="salvar()" #formFunc="ngForm" class="form-center">
    <div class="form-row">
      <label class="stack" style="min-width:260px;">
        <span class="muted">Nome do Funcionário:</span>
        <input name="nome" [(ngModel)]="funcionario.nome" required placeholder="Digite o nome">
      </label>

      <label class="stack" style="min-width:220px;">
        <span class="muted">Selecione o Departamento:</span>
        <select name="departamentoId" [(ngModel)]="funcionario.departamentoId" required>
          <option [ngValue]="null">Selecione</option>
          <option *ngFor="let dep of departamentos" [ngValue]="dep.id">{{ dep.nome }}</option>
        </select>
      </label>
    </div>

    <div class="form-row" style="margin-top:10px;">
      <label class="stack" style="min-width:200px;">
        <span class="muted">RG</span>
        <input name="rg" [(ngModel)]="funcionario.rg" placeholder="RG do funcionário">
      </label>

      <label class="stack" style="min-width:260px;">
        <span class="muted">Link da Foto</span>
        <input name="foto" [(ngModel)]="funcionario.foto" placeholder="https://...">
      </label>
    </div>

    <div class="form-row" style="justify-content:center; margin-top:12px;">
      <button type="submit" class="btn btn-primary">{{ editando ? 'Atualizar' : 'Cadastrar' }}</button>
      <button type="button" class="btn btn-ghost" (click)="cancelar()" *ngIf="editando">Cancelar</button>
    </div>
  </form>

  <div class="table-responsive" style="margin-top:18px;">
    <table class="data-table compact">
      <thead>
        <tr>
          <th>Nome do Funcionário</th>
          <th>DepartamentoID</th>
          <th>RG</th>
          <th>Foto</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let func of funcionarios">
          <td class="center">{{ func.nome }}</td>
          <td class="center">{{ func.departamentoId }}</td>
          <td class="center">{{ func.rg || '-' }}</td>
          <td class="center">{{ func.foto || '-' }}</td>
          <td class="center">
            <div class="table-actions">
              <button class="btn btn-editar" (click)="editarFuncionario(func)">Editar</button>
              <button class="btn btn-excluir" (click)="excluir(func.id)">Excluir</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
